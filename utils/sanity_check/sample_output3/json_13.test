set testdir [file dirname $argv0]
source $testdir/tester.tcl

# kill mutants ['28229']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_catchsql_test json-dredd-14.1 {
  CREATE TABLE t0(b);
  ALTER TABLE t0 ADD a;
  REPLACE INTO t0(a) VALUES(6), ('');
  ALTER TABLE t0 RENAME TO t1;
  SELECT ALL 0, 0, AVG(TIME()),
      AVG(''BETWEEN(json_array_length(a, 0)) AND(0)) FROM t1;
} {1 {bad JSON path: '0'}}

finish_test
