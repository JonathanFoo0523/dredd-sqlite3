set testdir [file dirname $argv0]
source $testdir/tester.tcl

# kill mutants ['4645']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_catchsql_test update-dredd-7.1 {
  CREATE TABLE a(b TEXT, PRIMARY KEY(b)) WITHOUT ROWID;
  UPDATE a SET b = 'hቛ';
  CREATE INDEX IF NOT EXISTS i73 ON a((b NOTNULL));
  UPDATE a SET b == 0xfffffffff9658d1e;
  ALTER TABLE a RENAME b TO c97;
  INSERT INTO a(c97) VALUES('94399978'), ('e8cd');
  UPDATE OR REPLACE a SET c97 =
      NULL WHERE CASE((((c97)))AND(a.c97))
          WHEN CASE a.c97 WHEN a.c97 THEN a.c97 END THEN(0)
              ELSE((c97)BETWEEN((a.c97)) AND((c97))) END;
} {1 {NOT NULL constraint failed: a.c97}}

finish_test
