set testdir [file dirname $argv0]
source $testdir/tester.tcl

# kill mutants ['3391']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test vdbemem-dredd-0.1 {
  CREATE VIRTUAL TABLE a USING rtree_i32(b, c, d);
  REPLACE INTO a VALUES('1130532845', 0, 0);
} {}

# kill mutants ['2974', '774']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test vdbemem-dredd-1.1 {
  CREATE VIRTUAL TABLE a USING rtree_i32(b, c, d);
  INSERT INTO a(c, d) VALUES(1.075523897E9, 1187613184);
  SELECT CAST(UPPER(b) AS TEXT) FROM a;
} {1}

# kill mutants ['3734', '3743']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test vdbemem-dredd-2.1 {
  CREATE VIRTUAL TABLE a USING rtree(b, c, d);
  CREATE VIEW e(b, c, d)
  AS SELECT FIRST_VALUE(0) OVER(), c, 0 FROM a;
  INSERT INTO a(d) VALUES('0a6e');
  REPLACE INTO a VALUES('ÈÅøM', 0, 'b7b43134');
  SELECT 0 FROM e JOIN a ON CASE e.c WHEN UPPER(e.c) THEN
      1 END WHERE e.c NOT BETWEEN a.d BETWEEN e.b AND 0 AND CASE e.d WHEN 0 THEN
      0 END;
} {0 0 0 0}

finish_test
