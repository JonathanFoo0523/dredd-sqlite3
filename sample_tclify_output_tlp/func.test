set testdir [file dirname $argv0]
source $testdir/tester.tcl

# kill mutants ['9117', '9149']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-1.1 {
  CREATE TABLE t0(c0);
  INSERT INTO t0 VALUES(0), ( '');
  INSERT OR ABORT INTO t0 VALUES(0);
  INSERT OR ABORT INTO t0 VALUES(x'');
  UPDATE OR IGNORE t0 SET c0 = 0.42568407331546176;
  INSERT OR ABORT INTO t0 VALUES('');
  INSERT OR IGNORE INTO t0 VALUES(0xfffffffffb5065c2);
  INSERT OR IGNORE INTO t0 VALUES(x''), (-504852730), (0.49874578595536523);
  UPDATE OR FAIL t0 SET c0 = NULL WHERE 0 BETWEEN((0)OR(t0.c0)) AND 0;
  INSERT OR IGNORE INTO t0 VALUES(NULL);
  INSERT OR FAIL INTO t0 VALUES(NULL);
  UPDATE OR ROLLBACK t0 SET c0 = x'', c0 = 0.5056564391211094 WHERE t0.c0 ISNULL
                                               COLLATE BINARY;
  ALTER TABLE t0 RENAME c0 TO c83;
  INSERT OR IGNORE INTO t0 VALUES('0.23080570450562599');
  SELECT TOTAL(c83)
  FROM t0;
} {-583469875.545087}

# kill mutants ['8987', '8988', '8991']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-2.1 {
  CREATE TABLE a(b, c, d, e, f);
  INSERT INTO a VALUES('', '', 0, 0, 0);
  SELECT 0 FROM a GROUP BY 1 HAVING AVG(b);
} {}

# kill mutants ['9113', '9145', '9152', '9184']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-3.1 {
   CREATE TABLE a (b );
                           INSERT INTO a VALUES (-7.861715E7)                 ;
                           INSERT INTO a VALUES (x'5b308da0'), (-504852730);
                           UPDATE a SET b=NULL WHERE 0 BETWEEN ((0)OR(b)) AND 0;
                           INSERT INTO a VALUES ('405841620'), ('252721741');
                           UPDATE a SET b==0.5056564391211094 WHERE b ISNULL ;
                           ALTER TABLE a RENAME b TO c;
                           SELECT TOTAL(c) FROM a;
} {75093481.5056564}

# kill mutants ['4723', '4724', '4725', '4726']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-4.1 {
  CREATE TABLE a(b);
  ALTER TABLE a RENAME TO c;
} {}

# kill mutants ['10122', '10154']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-5.1 {
  CREATE TABLE a(b, c, d, e, f);
  INSERT INTO a VALUES('', '', 0, 0, 0);
  SELECT 0 FROM a GROUP BY 1 HAVING TOTAL(b);
} {}

# kill mutants ['9222', '9223', '9224', '9225', '9227', '9254', '9255', '9256', '9257', '9259', '9298', '9330']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-6.1 {
  CREATE TABLE a(b);
  INSERT INTO a VALUES('-9223372036854775808'), (0.33190863679911764);
  ALTER TABLE a RENAME TO c;
  ALTER TABLE c RENAME b TO d;
  CREATE TABLE e(b);
  INSERT INTO e VALUES(0), ('342840741');
  ALTER TABLE c RENAME d TO f;
  SELECT SUM(f)
  FROM e, c;
} {-1.84467440737096e+19}

# kill mutants ['5568', '5573', '5578', '5583', '5584', '5585', '5586', '5587', '5588', '5596', '5597', '5600', '5605', '5610', '5615', '5616', '5617', '5618', '5619', '5620', '5628', '5629']
reset_db
sqlite3_db_config db DEFENSIVE 1
sqlite3_enable_load_extension db 1
do_catchsql_test func-dredd-7.1 {
  CREATE TABLE a(b);
  INSERT INTO a VALUES('1136689507');
  SELECT 0 FROM a WHERE load_extension(CHAR(b));
} {1 {�.so: cannot open shared object file: No such file or directory}}

# kill mutants ['9266']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_catchsql_test func-dredd-8.1 {
  CREATE TABLE b(c0);
     INSERT INTO b VALUES('-9223372036854775808');
     ALTER TABLE b RENAME TO a;
     ALTER TABLE a RENAME c0 TO c1;
     CREATE TABLE vt0(c0);
     INSERT INTO vt0 VALUES(0), ('342840741');
     ALTER TABLE a RENAME c1 TO c;
     SELECT SUM(CASE 0 WHEN 0 THEN c END) FROM vt0, a;
} {1 {integer overflow}}

# kill mutants ['8307']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-9.1 {
  CREATE VIRTUAL TABLE a USING rtree(b, c, d, +e);
  INSERT INTO a(b, d) VALUES('596127578', 0), (1667103273, 1);
  SELECT 0 FROM a WHERE((0, 0, 0, 0, 1) = (TRIM(1, b), 0,
                                           CASE b WHEN 1 THEN e END, f IN(),
                                           d)) UNION SELECT d FROM a
      WHERE(0, 0, 0, 0, 0 ) == (TRIM(0, b), 0, 0, 0, 0);
} {}

# kill mutants ['8945', '8946', '8947', '8948', '8950', '8951', '8956', '8958', '8962', '8965', '8966', '8979', '8980', '8981', '8982', '8983', '8997', '8998', '9011', '9012', '9013', '9014', '9015']
reset_db
sqlite3_db_config db DEFENSIVE 1
sqlite3_enable_load_extension db 1
do_catchsql_test func-dredd-10.1 {
  SELECT load_extension(0);
} {1 {0.so: cannot open shared object file: No such file or directory}}

# kill mutants ['10116', '10148']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-11.1 {
  CREATE TABLE a(b, c, d, e, f);
  INSERT INTO a VALUES('', '', 0, 0, 0);
  SELECT 0 FROM a GROUP BY 1 HAVING TOTAL(b) IS 0;
} {0}

# kill mutants ['11506']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-12.1 {
  PRAGMA case_sensitive_like = 0;
  SELECT LIKE(0, 0);
} {1}

# kill mutants ['5608']
# EXCLUDED DUE TO INVALID OUTPUT CHAR
# reset_db
# sqlite3_db_config db DEFENSIVE 1
# do_execsql_test func-dredd-13.1 {
#   SELECT CHAR(1);
# } {u0001}

# kill mutants ['8974', '8977', '8978', '9006', '9009', '9010']
reset_db
sqlite3_db_config db DEFENSIVE 1
sqlite3_enable_load_extension db 1
do_execsql_test func-dredd-14.1 {
  CREATE TABLE a(b);
  CREATE VIRTUAL TABLE c USING fts5('1808674176');
  ALTER TABLE a RENAME TO d;
  SELECT *FROM d RIGHT JOIN c(load_extension(b) ISNULL);
} {}

# kill mutants ['5569', '5572', '5601', '5604']
reset_db
sqlite3_db_config db DEFENSIVE 1
sqlite3_enable_load_extension db 1
do_catchsql_test func-dredd-15.1 {
  CREATE TABLE a(b);
  INSERT INTO a VALUES('-2063157890');
  SELECT 0 FROM a WHERE load_extension(CHAR(b));
} {1 {�.so: cannot open shared object file: No such file or directory}}

# kill mutants ['5609', '5611', '5612', '5613', '5614', '5621', '5622', '5625', '5626']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-16.1 {
  SELECT CHAR(0);
} {{}}

# kill mutants ['9359']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-17.1 {
  CREATE TABLE a(b, c, d);
  INSERT INTO a VALUES('97aa', '1496019907', 0),
      ('1749444160', 0.3336187551696136, 0);
  ALTER TABLE a RENAME c TO e;
  SELECT SUM(e)
  FROM a;
} {1496019907.33362}

# kill mutants ['1012', '980']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-18.1 {
  PRAGMA encoding = 'UTF16le';
  CREATE TABLE a(b);
  INSERT INTO a VALUES('886332416');
  CREATE TABLE c(b, d);
  INSERT INTO c VALUES(4.52215394E8, 'AAg9t챦\{z');
  ALTER TABLE a RENAME b TO e;
  ALTER TABLE a RENAME TO f;
  SELECT 0 FROM c JOIN f ON INSTR(CAST(b AS BLOB), 0);
} {0}

# kill mutants ['982']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-19.1 {
    CREATE VIRTUAL TABLE b USING fts5(a  );
           INSERT   INTO b(a) VALUES (x'eadf');
           SELECT 1 FROM b ((((0)OR(INSTR('1961691963', b.a)))))        ;
} {}

# kill mutants ['9035', '9036', '9067', '9068']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-20.1 {
  CREATE TABLE vt0(a);
  INSERT INTO vt0 VALUES('H ⻫B<쿴&Q ');
  INSERT INTO vt0 VALUES('Mzl');
  INSERT INTO vt0 VALUES('');
  INSERT OR ABORT INTO vt0 VALUES(0), (x''), (0);
  CREATE TABLE b(c);
  REPLACE INTO b VALUES(0), (0), (0);
  SELECT SUM(0.18393692765879466) FROM b, vt0;
} {3.3108646978583}

# kill mutants ['7720']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-21.1 {
  SELECT TRIM(0);
} {0}

# kill mutants ['1014']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-22.1 {
  CREATE  TABLE vt0  (c0   );
           INSERT   INTO vt0 VALUES  (x'eadf');
           SELECT 0 FROM vt0 WHERE (((((INSTR('1961691963', vt0.c0))))))      ;
} {}

# kill mutants ['9025', '9057', '9931', '9963']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-23.1 {
  CREATE TABLE a(b);
  CREATE TABLE c(d);
  INSERT INTO a VALUES(0), (0), ('1779537756');
  INSERT INTO a VALUES(''), (x''), (x'');
  REPLACE INTO c VALUES(0), (0), (0);
  SELECT SUM(0.18393692765879466) FROM c, a;
} {3.3108646978583}

# kill mutants ['8275']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-24.1 {
  CREATE TABLE a(b);
  ALTER TABLE a ADD c55;
  INSERT INTO a(c55) VALUES(0.7389701354464181);
  ALTER TABLE a RENAME TO t1;
  ALTER TABLE t1 RENAME c55 TO c;
  VACUUM;
  SELECT 0 FROM t1 WHERE(((TRIM(c, -9.65209054E8))));
} {0}

# kill mutants ['9234']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_catchsql_test func-dredd-25.1 {
  CREATE TABLE c(a);
  INSERT INTO c VALUES('-9223372036854775808');
  ALTER TABLE c RENAME TO b;
  ALTER TABLE b RENAME a TO c1;
  CREATE VIRTUAL TABLE d USING fts5(0);
  INSERT INTO d VALUES(0), ('342840741');
  ALTER TABLE b RENAME c1 TO f;
  CREATE TABLE c(e);
  CREATE VIEW v0(a, c1, e)
  AS SELECT 0, COUNT(), 0 FROM c;
  SELECT SUM(CASE FALSE WHEN(c1)
                 THEN CASE WHEN 0 THEN 0 ELSE f END END) FROM d,
      b, v0 ;
} {1 {integer overflow}}

# kill mutants ['9253']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-26.1 {
  CREATE TABLE a(b);
   INSERT INTO a VALUES('');
   INSERT INTO a VALUES(0xffffffffe7f7df97);
   SELECT TOTAL(b) FROM a;
} {-403185769.0}

# kill mutants ['8292']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-27.1 {
          CREATE TABLE a ( INTEGER  );
             ALTER TABLE a ADD c55 ;
             INSERT   INTO a(c55) VALUES  (0.7389701354464181);
             ALTER TABLE a RENAME TO b
             ;
             ALTER TABLE b RENAME c55 TO c59
             ;
                   VACUUM       ;
             SELECT  1 FROM b  WHERE TRIM(c59, -9.65209054E8);
} {1}

# kill mutants ['8961']
reset_db
sqlite3_db_config db DEFENSIVE 1
sqlite3_enable_load_extension db 1
do_catchsql_test func-dredd-28.1 {
  CREATE  TABLE    t0 (c0   );
               REPLACE INTO t0 VALUES (0);
             ALTER TABLE t0 RENAME c0 TO a;
             ALTER TABLE t0 ADD c81 ;
             ALTER TABLE t0 RENAME a TO c41;
             SELECT c41 FROM t0 WHERE (load_extension('2114441314', c81) );
} {1 {2114441314.so: cannot open shared object file: No such file or directory}}

# kill mutants ['8989']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-29.1 {
  CREATE TABLE a(b, c);
  INSERT INTO a VALUES('1209862559', 0), (0, 'T\rQf');
  SELECT TOTAL(0.30157046966314405) FROM a;
} {0.603140939326288}

# kill mutants ['8993']
reset_db
sqlite3_db_config db DEFENSIVE 1
sqlite3_enable_load_extension db 1
do_catchsql_test func-dredd-30.1 {
  CREATE TABLE a(b, c);
  INSERT INTO a(b) VALUES( '');
  SELECT 0 FROM a WHERE(load_extension(0, 0));
} {1 {0.so: cannot open shared object file: No such file or directory}}

# kill mutants ['8994']
reset_db
sqlite3_db_config db DEFENSIVE 1
sqlite3_enable_load_extension db 1
do_catchsql_test func-dredd-31.1 {
  VALUES(0 BETWEEN(load_extension(0)) AND 0);
} {1 {0.so: cannot open shared object file: No such file or directory}}

# kill mutants ['4099']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-32.1 {
  CREATE TABLE a(b);
  ALTER TABLE a RENAME b TO c;
  INSERT INTO a VALUES('*[e0SWk');
  ALTER TABLE a RENAME c TO d;
  SELECT *FROM a WHERE(0) GLOB(d);
} {}

# kill mutants ['9391']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-33.1 {
  CREATE VIRTUAL TABLE a USING rtree_i32(b, c, d);
  INSERT INTO a(b) VALUES(1161616266);
  INSERT INTO a(d) VALUES('1161616266'), (0), (0);
  CREATE VIRTUAL TABLE e USING fts4;
  INSERT INTO e VALUES(''), (0);
  SELECT TOTAL(b << HEX(0)) FROM e, a;
} {9.97820775882818e+18}

# kill mutants ['10041']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-34.1 {
   CREATE  TABLE rt0  (c0  );
    SELECT(AVG(0)) FROM rt0;
} {{}}

# kill mutants ['2330']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-35.1 {
  SELECT ROUND('' );
} {0.0}

# kill mutants ['2319', '2322']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-36.1 {
  CREATE VIRTUAL TABLE a USING fts4;
  INSERT INTO a VALUES(0);
  CREATE VIRTUAL TABLE b USING fts5(0);
  INSERT INTO b VALUES('');
  SELECT *FROM a, b(0 <= ROUND(a, b));
} {}

# kill mutants ['8305']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-37.1 {
  CREATE  TABLE a  (c1, c2);
  CREATE TABLE t1(REAL);
  ALTER TABLE t1 ADD c34;
  ALTER TABLE t1 RENAME TO t0;
  INSERT INTO t0(c34) VALUES(0.3363195778274122);
  ALTER TABLE t0 RENAME c34 TO c15;
  REPLACE INTO a(c2) VALUES(0.16842794055130283);
  INSERT INTO t0(c15) VALUES(0.03734493651087045);
  UPDATE a SET c1 =- 086814867;
  SELECT *FROM a JOIN t0 ON(rtreenode(TRIM(1, c15), 0))
      UNION SELECT  *FROM a   JOIN t0
      ON(((rtreenode(TRIM(c1, c15),   0   ))));
} {}

# kill mutants ['10121', '10153']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-38.1 {
  CREATE TABLE a(b, c, d, e, f);
  INSERT INTO a VALUES('679704789', 0, 'cc9b', '', 0);
  SELECT 0 FROM a GROUP BY 1 HAVING TOTAL(d);
} {}

# kill mutants ['2336']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-39.1 {
  CREATE TABLE a(b, c);
  INSERT INTO a(b) VALUES('_c');
  UPDATE a SET c = 0.703476042224604;
  SELECT ROUND(c, 0) FROM a;
} {1.0}

# kill mutants ['8995']
reset_db
sqlite3_db_config db DEFENSIVE 1
sqlite3_enable_load_extension db 1
do_catchsql_test func-dredd-40.1 {
  CREATE VIRTUAL TABLE a USING rtree(b, c1, c2);
                      INSERT OR ROLLBACK INTO a(b) VALUES (x'');
                      SELECT 1 FROM  a WHERE ((load_extension(c2, b) ));
} {1 {0.0.so: cannot open shared object file: No such file or directory}}

# kill mutants ['2325']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-41.1 {
  CREATE TABLE a(b);
  ALTER TABLE a RENAME TO c;
  CREATE VIEW d(e)
  AS SELECT SUM(0) FROM c;
  SELECT ROUND(e)
  FROM d;
} {{}}

# kill mutants ['8990']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-42.1 {
  CREATE TABLE t0(a, b, c, d, e);
  ALTER TABLE t0 RENAME d TO f;
  INSERT INTO t0 VALUES('', '', 0, 1, 0);
  INSERT OR IGNORE INTO t0 VALUES('', 0, x'', '', 0);
  SELECT SUM(f)
  FROM t0;
} {1.0}

# kill mutants ['2328']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-43.1 {
  SELECT ROUND(1);
} {1.0}

# kill mutants ['4635']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-44.1 {
  CREATE TABLE a(e);
  CREATE VIRTUAL TABLE c USING rtree(f, b, e, +d);
  REPLACE INTO c(f) VALUES(0);
  SELECT 0 FROM c JOIN a ON GLOB(d, '1682444631');
} {}

# kill mutants ['4727']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-45.1 {
  SELECT SQLITE_SOURCE_ID();
} {{2024-01-30 16:01:20 e876e51a0ed5c5b3126f52e532044363a014bc594cfefa87ffb5b82257cc467a}}

# kill mutants ['8273']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test func-dredd-46.1 {
  CREATE TABLE a(d);
     ALTER TABLE a ADD b;
     INSERT INTO a(b) VALUES(0.7389701354464181);
     ALTER TABLE a RENAME TO t1;
     ALTER TABLE t1 RENAME b TO c;
     VACUUM;
     SELECT 0 FROM t1 WHERE(TRIM(c, -9.65209054E8));
} {0}

finish_test
