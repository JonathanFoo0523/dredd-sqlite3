set testdir [file dirname $argv0]
source $testdir/tester.tcl

# kill mutants ['3978', '3980', '3982', '3983', '3986', '3987']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_catchsql_test update-dredd-1.1 {
   CREATE TEMPORARY TABLE t0 (c0 INT CHECK ( CASE WHEN (((c0)) BETWEEN ((c0)) AND ((c0))) THEN (c0 IN (c0)) WHEN CASE c0  WHEN NULL THEN c0 WHEN c0 THEN c0 WHEN c0 THEN c0 WHEN '[<' THEN c0 WHEN 0.028513559707247893 THEN c0 ELSE c0 END THEN ((c0)) WHEN CASE WHEN c0 THEN c0 WHEN c0 THEN c0 WHEN c0 THEN c0 WHEN 0.967381428057329 THEN c0 WHEN c0 THEN c0 ELSE c0 END THEN '1837732451' WHEN CAST(0.47107406469867164 AS BLOB) THEN ((c0)) WHEN x'' THEN TIME(c0, c0, c0) ELSE c0 COLLATE RTRIM END) );
                           CREATE TEMPORARY VIEW  v00 AS SELECT ALL CASE WHEN CASE WHEN t0.c0 THEN t0.c0 END THEN 0.8972418066691166 WHEN t0.c0 THEN (((t0.c0)) BETWEEN ((t0.c0)) AND ((t0.c0))) WHEN CASE t0.c0  WHEN t0.c0 THEN t0.c0 ELSE t0.c0 END THEN (LIKE(t0.c0)) WHEN ((t0.c0) NOT NULL) THEN ((t0.c0) NOT NULL) WHEN MAX(t0.c0) THEN (t0.c0 IN ()) END FROM t0 WHERE 0;
                           ALTER TABLE t0 RENAME TO t1;
                          ALTER TABLE t1 RENAME c0 TO c22;
} {1 {error in view v00: no such column: t1.c22}}

# kill mutants ['178']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test update-dredd-2.1 {
  CREATE TABLE t1(a);
  ALTER TABLE t1 ADD c75;
  ALTER TABLE t1 RENAME a TO c45;
  ALTER TABLE t1 ADD b;
  INSERT INTO t1(b, c75) VALUES( '', 0);
  CREATE INDEX i15 ON t1(c75 COLLATE RTRIM,
                         CASE WHEN 0 THEN 0 ELSE 0 END COLLATE BINARY,
                         CASE WHEN 1 THEN c45 ELSE 0 END);
  UPDATE OR IGNORE t1 SET c45 = 0;
  UPDATE OR IGNORE t1 SET c75 ='';
} {}

# kill mutants ['175', '179']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test update-dredd-3.1 {
  CREATE TABLE t1(a);
  ALTER TABLE t1 ADD c75;
  ALTER TABLE t1 RENAME a TO c45;
  ALTER TABLE t1 ADD b;
  INSERT INTO t1(b, c75) VALUES( '', 0);
  CREATE INDEX i15 ON t1(0 COLLATE RTRIM,
                         CASE WHEN 0 THEN 0 ELSE CAST(c75 AS) END COLLATE BINARY,
                         CASE WHEN 1 THEN c45 ELSE 0 END);
  UPDATE OR IGNORE t1 SET c45 = 0;
  UPDATE OR IGNORE t1 SET c75 ='';
} {}

# kill mutants ['3760']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test update-dredd-4.1 {
  CREATE TABLE a(b PRIMARY KEY, c)
  WITHOUT ROWID;
  INSERT INTO a VALUES(0, '3ejUu>ã‚’8');
  UPDATE a SET(c) = (0)OR(0);
  SELECT *FROM a;
} {0 0}

finish_test
