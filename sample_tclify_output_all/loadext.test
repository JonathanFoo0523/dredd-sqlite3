set testdir [file dirname $argv0]
source $testdir/tester.tcl

# kill mutants ['0', '10', '12', '13', '18', '20', '21', '22', '23', '24', '25', '26', '27', '28', '3', '35', '37', '39', '40', '41', '42', '44', '45', '5', '50', '52', '53', '54', '55', '56', '57', '58', '59', '60', '62', '7', '751', '752', '753', '754', '756', '757', '759', '760', '761', '762', '764', '767', '768', '769', '771', '772', '775', '776', '777', '779', '785', '794', '8', '800', '801', '803', '804', '807', '808', '809', '811', '826', '9', '922', '923', '924', '925', '926', '927', '934', '935', '939', '940', '942', '944', '945', '947', '948', '954', '955', '956', '957', '958', '959', '998']
reset_db
sqlite3_db_config db DEFENSIVE 1
sqlite3_enable_load_extension db 1
do_catchsql_test loadext-dredd-1.1 {
  SELECT load_extension(CASE WHEN '1053010141' THEN '' END);
} {1 {unable to open shared library []}}

# kill mutants ['950', '951', '952']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test loadext-dredd-2.1 {
  PRAGMA short_column_names;
} {1}

# kill mutants ['933', '936', '937', '938', '941', '946']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test loadext-dredd-3.1 {
  ANALYZE;
} {}

# kill mutants ['66']
reset_db
sqlite3_db_config db DEFENSIVE 1
sqlite3_enable_load_extension db 1
do_catchsql_test loadext-dredd-4.1 {
  SELECT load_extension(4);
} {1 {4.so: cannot open shared object file: No such file or directory}}

# kill mutants ['98']
reset_db
sqlite3_db_config db DEFENSIVE 1
sqlite3_enable_load_extension db 1
do_catchsql_test loadext-dredd-5.1 {
  SELECT load_extension('.觵	늜');
} {1 {.觵	늜.so: cannot open shared object file: No such file or directory}}

# kill mutants ['38', '6']
reset_db
sqlite3_db_config db DEFENSIVE 1
sqlite3_enable_load_extension db 1
do_catchsql_test loadext-dredd-6.1 {
  SELECT load_extension(0);
} {1 {0.so: cannot open shared object file: No such file or directory}}

# kill mutants ['953']
reset_db
sqlite3_db_config db DEFENSIVE 1
do_execsql_test loadext-dredd-7.1 {
  CREATE VIRTUAL TABLE a USING fts5(0);
  REPLACE INTO a VALUES('1189789218');
} {}

finish_test
